/*! JRoll-Infinite v2.2.0 ~ (c) 2016-2017 Author:BarZu Git:https://github.com/chjtx/JRoll/tree/master/extends/jroll-infinite */
!function(e,i,n){"use strict";function t(e,i){var n=e,t="'use strict';\nvar __t='';__t+='",l=0,o=/\{\{=([^{]+)\}\}|\{\{(each [\w$._]+ as [\w$_]+ [\w$_]+)\}\}|\{\{if ([^{]+)\}\}|\{\{(else)\}\}|\{\{else if ([^{]+)\}\}|(\{\{\/each\}\}|\{\{\/if\}\})|\{\{([^{]+)\}\}/g;return n=n.replace(/(\n|\r)|(\{\{\s+)|(\s+\}\})|(\s{2,})|(')/g,function(e,i,n,t,l,o){var r;return i?r="":n?r="{{":t?r="}}":l?r=" ":o&&(r="\\'"),r}),n.replace(o,function(e,i,o,r,a,s,c,p,f){if(t+=n.slice(l,f),l=f+e.length,i)t+="'+("+i.replace(/\\'/g,"'")+")+'";else if(o){var d=o.split(" ");t+="';\nfor(var "+d[4]+"=0,"+d[3]+";"+d[4]+"<"+d[1]+".length;"+d[4]+"++){\n"+d[3]+"="+d[1]+"["+d[4]+"];\n__t+='"}else r?t+="';\nif("+r.replace(/\\'/g,"'")+"){\n__t+='":a?t+="';\n}else{\n__t+='":s?t+="';\n}else if("+s.replace(/\\'/g,"'")+"){\n__t+='":c?t+="';\n};\n__t+='":p&&(t+="';\n"+p.replace(/\\'/g,"'")+";\n__t+='");return e}),t+=n.slice(l)+"';return __t;",new Function(i,t)}function l(e,i){return e(i)}n.prototype.infinite=function(e){function n(){var e=c.scroller.querySelector(".jroll-infinite-tip");e.innerHTML=f.errorTip,--c.options.page,a=!1}function o(e){var i;if(a=!1,e){i="<section class='jroll-infinite-page'>";for(var n=0,t=e.length;n<t;n++)i+=f.render(s,e[n],n);i+="</section>",i+=c.options.total===c.options.page?f.completeTip:f.loadingTip,c.scroller.lastElementChild&&c.scroller.removeChild(c.scroller.lastElementChild),c.scroller.insertAdjacentHTML("beforeend",i),c.refresh(),(f.hideImg||f.blank)&&setTimeout(function(){var e=c.scroller.querySelectorAll(".jroll-infinite-page"),i=e[e.length-1];i&&(i.style.height=i.offsetHeight+"px"),r(e)},10)}}function r(e){if(f.hideImg||f.blank)for(var i=e||c.scroller.querySelectorAll(".jroll-infinite-page"),n=c.wrapper.clientHeight,t=c.y,l=f.blank?"jroll-infinite-hide":"jroll-infinite-hideimg",o=0,r=i.length;o<r;o++)i[o].offsetTop-n+t>0||i[o].offsetTop+i[o].offsetHeight+t<0?i[o].classList.add(l):i[o].classList.remove(l)}var a,s,c=this,p=Object.keys(e||{}),f={total:99,getData:null,hideImg:!1,blank:!1,template:"",loadingTip:'<div class="jroll-infinite-tip">正在加载...</div>',completeTip:'<div class="jroll-infinite-tip">已加载全部内容</div>',errorTip:'<div class="jroll-infinite-tip">加载失败，上拉重试！</div>',root:"_obj",compile:t,render:l};for(var d in p)f[p[d]]=e[p[d]];c.options.total=f.total,c.options.page=1,c.infinite_callback=o,c.infinite_error_callback=n,s=f.compile(f.template,f.root);var g=i.getElementById("jroll_style"),u="\n/* jroll-infinite */\n.jroll-infinite-hide>*{display:none}.jroll-infinite-hideimg img{display:none}\n";g?/jroll-infinite/.test(g.innerHTML)||(g.innerHTML+=u):(g=i.createElement("style"),g.id="jroll_style",g.innerHTML=u,i.head.appendChild(g)),i.createElement("div").innerHTML=f.loadingTip+f.completeTip,"function"==typeof f.getData&&(c.scroller.innerHTML=f.loadingTip,f.getData(c.options.page,o,n)),c.on("scrollEnd",function(){var e=c.scroller.querySelector(".jroll-infinite-tip");c.y<c.maxScrollY+e.offsetHeight&&c.options.page!==c.options.total&&!a&&(a=!0,e.innerHTML=f.loadingTip,f.getData(++c.options.page,o,n)),r()})},n.prototype.infinite.version="2.2.0","undefined"!=typeof module&&module.exports&&(module.exports=n),"function"==typeof define&&define(function(){return n})}(window,document,JRoll);